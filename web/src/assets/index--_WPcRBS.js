import{j as t,C as h,R as P,t as j}from"./semi-ui-C9AnQoBc.js";import{r as a}from"./react-core-B_rT1BcQ.js";import{S as k,a as N,A as B,s as T,b as D,t as W}from"./index-BAKq1-I6.js";import{m as _}from"./tools--jVf5iHv.js";import{u as M}from"./i18n-CErUK-Hy.js";import"./react-components-DHMQhW6Z.js";import"./semantic-Du-5yReK.js";const Q=()=>{var m,d,p,g,x,C,A,E,f;const{t:u,i18n:w}=M(),[e]=a.useContext(k),[y,b]=a.useState(!1),[c,l]=a.useState("");a.useContext(N);const I=async()=>{const r=await B.get("/api/notice"),{success:n,message:F,data:s}=r.data;if(n){let i=localStorage.getItem("notice");if(s!==i&&s!==""){const o=_(s);T(o,!0),localStorage.setItem("notice",s)}}else D(F)},v=async()=>{l(localStorage.getItem("home_page_content")||"");const r=await B.get("/api/home_page_content"),{success:n,message:F,data:s}=r.data;if(n){let i=s;if(s.startsWith("https://")||(i=_.parse(s)),l(i),localStorage.setItem("home_page_content",i),s.startsWith("https://")){const o=document.querySelector("iframe");if(o){const H=localStorage.getItem("theme-mode")||"light";o.onload=()=>{o.contentWindow.postMessage({themeMode:H},"*"),o.contentWindow.postMessage({lang:w.language},"*")}}}}else D(F),l("加载首页内容失败...");b(!0)},L=()=>{var n;const r=(n=e==null?void 0:e.status)==null?void 0:n.start_time;return e.status?W(r):""};return a.useEffect(()=>{I().then(),v().then()}),t.jsx(t.Fragment,{children:y&&c===""?t.jsx(t.Fragment,{children:t.jsx(h,{bordered:!1,headerLine:!1,title:u("系统状况"),bodyStyle:{padding:"10px 20px"},children:t.jsxs(P,{gutter:16,children:[t.jsx(j,{span:12,children:t.jsxs(h,{title:u("系统信息"),headerExtraContent:t.jsx("span",{style:{fontSize:"12px",color:"var(--semi-color-text-1)"},children:u("系统信息总览")}),children:[t.jsxs("p",{children:[u("名称"),"：",(m=e==null?void 0:e.status)==null?void 0:m.system_name]}),t.jsxs("p",{children:[u("版本"),"：",(d=e==null?void 0:e.status)!=null&&d.version?(p=e==null?void 0:e.status)==null?void 0:p.version:"unknown"]}),t.jsxs("p",{children:[u("源码"),"：",t.jsx("a",{href:"https://github.com/Calcium-Ion/new-api",target:"_blank",rel:"noreferrer",children:"https://github.com/Calcium-Ion/new-api"})]}),t.jsxs("p",{children:[u("协议"),"：",t.jsx("a",{href:"https://www.apache.org/licenses/LICENSE-2.0",target:"_blank",rel:"noreferrer",children:"Apache-2.0 License"})]}),t.jsxs("p",{children:[u("启动时间"),"：",L()]})]})}),t.jsx(j,{span:12,children:t.jsxs(h,{title:u("系统配置"),headerExtraContent:t.jsx("span",{style:{fontSize:"12px",color:"var(--semi-color-text-1)"},children:u("系统配置总览")}),children:[t.jsxs("p",{children:[u("邮箱验证"),"：",((g=e==null?void 0:e.status)==null?void 0:g.email_verification)===!0?u("已启用"):u("未启用")]}),t.jsxs("p",{children:[u("GitHub 身份验证"),"：",((x=e==null?void 0:e.status)==null?void 0:x.github_oauth)===!0?u("已启用"):u("未启用")]}),t.jsxs("p",{children:[u("微信身份验证"),"：",((C=e==null?void 0:e.status)==null?void 0:C.wechat_login)===!0?u("已启用"):u("未启用")]}),t.jsxs("p",{children:[u("Turnstile 用户校验"),"：",((A=e==null?void 0:e.status)==null?void 0:A.turnstile_check)===!0?u("已启用"):u("未启用")]}),t.jsxs("p",{children:[u("Telegram 身份验证"),"：",((E=e==null?void 0:e.status)==null?void 0:E.telegram_oauth)===!0?u("已启用"):u("未启用")]}),t.jsxs("p",{children:[u("Linux DO 身份验证"),"：",((f=e==null?void 0:e.status)==null?void 0:f.linuxdo_oauth)===!0?u("已启用"):u("未启用")]})]})})]})})}):t.jsx(t.Fragment,{children:c.startsWith("https://")?t.jsx("iframe",{src:c,style:{width:"100%",height:"100vh",border:"none"}}):t.jsx("div",{style:{fontSize:"larger"},dangerouslySetInnerHTML:{__html:c}})})})};export{Q as default};
